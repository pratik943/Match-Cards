@font-face {
    font-family: "Creepy";
    src: url("Assets/Fonts/Creepy.woff") format("woff"),
         url("Assets/Fonts/Creepy.woff2") format("woff2");
}

@font-face {
    font-family: "Lunacy";
    src: url("Assets/Fonts/Lunacy.woff") format("woff"),
         url("Assets/Fonts/Lunacy.woff2") format("woff2");
}

* {
  box-sizing: border-box;
}

html {
  min-height: 100vh;
  cursor: url(Assets/Cursors/Ghost.cur), auto;
  font-family: Lunacy;
}

body {
  margin: 0;
  background: radial-gradient(#9D5900, #3D2200);
}

.page-title {
  color: #FF6D00;
  font-family: Creepy, serif;
  font-weight: normal;
  text-align: center;
  font-size: 6em;
}

.game-info-container {
  grid-column: 1 / -1;
  display: flex;
  justify-content: space-between;
}

.game-info {
  color: #FFBB89;
  font-size: 4em;
}

.game-container {
  margin: 50px auto;
  display: grid;
  grid-template-columns: repeat(4, auto);
  grid-gap: 10px;
  justify-content: center;
  perspective: 500px;
}

.card {
  position: relative;
  cursor: url("Assets/Cursors/GhostHover.cur"), auto;
  height: 175px;
  width: 125px;
}

.card-face {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  border-radius: 12px;
  border-width: 1px;
  border-style: solid;
  overflow: hidden;
  transition: transform 500ms ease-in-out;
  backface-visibility: hidden;
}

.card.visible .card-back { transform: rotateY(-180deg); }
.card.visible .card-front { transform: rotateY(0); }

.card.matched .card-front .card-value {
  animation: dance 1s linear infinite 500ms;
}

.card-back {
  background-color: black;
  border-color: #FF6D00;
  transform: rotateY(0);
}

.cob-web {
  position: absolute;
  transition: width 100ms ease-in-out, height 100ms ease-in-out;
  width: 47px;
  height: 47px;
}

.card-face:hover .cob-web { width: 52px; height: 52px; }

.cob-web-top-left { transform: rotate(270deg); top: 0; left: 0; }
.cob-web-top-right { top: 0; right: 0; }
.cob-web-bottom-left { transform: rotate(180deg); bottom: 0; left: 0; }
.cob-web-bottom-right { transform: rotate(90deg); bottom: 0; right: 0; }

.spider {
  align-self: flex-start;
  transition: transform 100ms ease-in-out;
  transform: translateY(-10px);
}

.card-back:hover .spider { transform: translateY(0); }

.card-value {
  position: relative;
  transition: transform 100ms ease-in-out;
  transform: scale(.9);
}

.card-front:hover .card-value { transform: scale(1); }

.card-front {
  background-color: #FFBB89;
  border-color: #333;
  transform: rotateY(180deg);
}

.overlay-text {
  top: 0; left: 0; right: 0; bottom: 0;
  z-index: 100;
  display: none;
  position: fixed;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #FF6D00;
  font-family: Creepy, serif;
  transition: background-color 500ms, font-size 500ms;
}

.overlay-text-small { font-size: .3em; }

.overlay-text.visible {
  display: flex;
  animation: overlay-grow 500ms forwards;
}

@keyframes dance {
  0%, 100% { transform: rotate(0) }
  25%      { transform: rotate(-30deg) }
  75%      { transform: rotate(30deg) }
}

@keyframes overlay-grow {
  from { background-color: rgba(0, 0, 0, 0); font-size: 0; }
  to   { background-color: rgba(0, 0, 0, .8); font-size: 10em; }
}

@media (max-width: 600px) {
  .game-container { grid-template-columns: repeat(2, auto) }
  .game-info-container { flex-direction: column; align-items: center; }
}

/* =====================================================
   Farcaster miniapp: zoomed desktop + alignment tweaks
   - desktop board kept at original size, then scaled
   - title kept visible
   - grid nudged slightly left and lower
===================================================== */
html.in-miniapp,
body.in-miniapp {
  height: 100svh;
  overflow: hidden;
  overscroll-behavior: none;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  background: radial-gradient(#9D5900, #3D2200);
}

/* keep the title visible and nicely sized */
body.in-miniapp .page-title {
  font-size: clamp(2.6rem, 8vw, 3.6rem);
  margin: 16px 0 8px; /* more top space so it never clips */
  text-align: center;
}

/* slightly smaller counters so the board has room */
body.in-miniapp .game-info {
  font-size: clamp(1.6rem, 6vw, 2.6rem);
  margin: 4px 12px;
}

/* base desktop grid dimensions (no scale) */
body.in-miniapp {
  --baseW: 530px; /* 4*125 + 3*10 */
  --baseH: 730px; /* 4*175 + 3*10 */
  --headerSpace: 160px;            /* title + counters + margins */
  --availW: calc(100vw - 24px);    /* a little side padding */
  --availH: calc(100svh - var(--headerSpace));
  --scaleX: calc(var(--availW) / var(--baseW));
  --scaleY: calc(var(--availH) / var(--baseH));
  --miniapp-scale: min(var(--scaleX), var(--scaleY), 1);
}

/* keep desktop layout; just scale it, then offset left/down */
body.in-miniapp .game-container {
  width: var(--baseW);
  height: var(--baseH);
  margin: 20px auto 12px;           /* push a bit lower */
  margin-left: -10px;               /* nudge slightly left; adjust to taste */
  transform-origin: top center;
  transform: scale(var(--miniapp-scale));
  will-change: transform;
}

/* ensure card boxes & faces always fill the scaled grid cell */
body.in-miniapp .card,
body.in-miniapp .card-face {
  width: 100%;
  height: 100%;
}

/* smaller overlay animation so it fits on miniapp */
@keyframes overlay-grow-mini {
  from { background-color: rgba(0,0,0,0); font-size: 0; }
  to   { background-color: rgba(0,0,0,.8); font-size: 6rem; }
}
body.in-miniapp .overlay-text.visible {
  animation: overlay-grow-mini 400ms forwards;
}
/* === Force 4x4 grid inside Farcaster miniapp === */
body.in-miniapp .game-container {
  display: grid !important;
  grid-template-columns: repeat(4, auto) !important;
  grid-auto-rows: auto;
  grid-gap: 10px;
  justify-content: center;
}
/* ===== Farcaster miniapp: true 4×4, no distortion, no scroll ===== */
html.in-miniapp,
body.in-miniapp {
  height: 100svh;
  overflow: hidden;
  overscroll-behavior: none;
  display: flex;
  justify-content: center;
  align-items: flex-start;
}

/* Title + counters (keep visible, compact) */
body.in-miniapp .page-title { font-size: clamp(2.4rem, 8vw, 3.4rem); margin: 14px 0 6px; }
body.in-miniapp .game-info   { font-size: clamp(1.6rem, 6vw, 2.4rem); margin: 4px 12px; }

/* --- Layout math for perfect 4×4 ---
   We compute the card width from BOTH available width and height,
   then pick the smaller so the board fits without squishing.
*/
body.in-miniapp {
  --cols: 4;
  --rows: 4;
  --gap: 10px;             /* matches your desktop gap */
  --sidePad: 24px;         /* tiny breathing room on sides */
  --headerSpace: 150px;    /* title + counters + margins */

  --availW: calc(100vw - var(--sidePad));
  --availH: calc(100svh - var(--headerSpace));

  /* width-fit: (availW - gaps) / 4 */
  --widthFit: calc((var(--availW) - (var(--cols) - 1) * var(--gap)) / var(--cols));
  /* height-fit: convert per-row height to width using 5:7 ratio
     perRowH = (availH - gaps)/4  => cardW = perRowH * 5/7
  */
  --heightFit: calc(((var(--availH) - (var(--rows) - 1) * var(--gap)) / var(--rows)) * 5 / 7);

  /* Final card width = min(widthFit, heightFit) */
  --cardW: min(var(--widthFit), var(--heightFit));
}

/* Force 4 columns; position a bit left & down as requested */
body.in-miniapp .game-container {
  display: grid !important;
  grid-template-columns: repeat(4, var(--cardW)) !important;
  grid-auto-rows: auto;
  grid-gap: var(--gap);
  justify-content: center;
  margin: 16px auto 12px;
  margin-left: -8px;    /* nudge left; tweak to taste */
}

/* Critical: NO transform scaling (prevents squish) */
body.in-miniapp .game-container { transform: none !important; }

/* Cards keep aspect ratio perfectly (125×175 → 5:7) */
body.in-miniapp .card {
  width: var(--cardW);
  aspect-ratio: 5 / 7;
  height: auto;           /* aspect-ratio drives height */
}

/* Faces still fill the card box */
body.in-miniapp .card-face { width: 100%; height: 100%; }
/* ==== Farcaster miniapp: desktop-look via zoom (always 4x4) ==== */
html.in-miniapp,
body.in-miniapp {
  height: 100svh;
  overflow: hidden;
  overscroll-behavior: none;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  background: radial-gradient(#9D5900, #3D2200);
}

/* keep title/counters visible but compact */
body.in-miniapp .page-title { font-size: clamp(2.4rem, 8vw, 3.4rem); margin: 14px 0 6px; }
body.in-miniapp .game-info   { font-size: clamp(1.5rem, 6vw, 2.2rem); margin: 2px 10px; }

/* Desktop board dimensions (no scale) */
body.in-miniapp {
  --baseW: 530px;  /* 4*125 + 3*10 */
  --baseH: 730px;  /* 4*175 + 3*10 */
  --sidePad: 20px;
  --headerSpace: 130px; /* title + counters + margins */

  --availW: calc(100vw - var(--sidePad));
  --availH: calc(100svh - var(--headerSpace));

  --scaleX: calc(var(--availW) / var(--baseW));
  --scaleY: calc(var(--availH) / var(--baseH));
  --miniapp-scale: min(var(--scaleX), var(--scaleY), 1);
}

/* Freeze layout at desktop size; then scale down to fit */
body.in-miniapp .game-container {
  width: var(--baseW);
  height: var(--baseH);
  display: grid;
  grid-template-columns: repeat(4, 125px); /* force 4 columns */
  grid-gap: 10px;
  justify-content: center;
  margin: 12px auto 12px;
  transform-origin: top center;
  transform: scale(var(--miniapp-scale));
}

/* Override your mobile @media (which sets 2 columns under 600px) */
@media (max-width: 600px) {
  body.in-miniapp .game-container {
    grid-template-columns: repeat(4, 125px) !important;
  }
}

/* Keep card boxes at desktop size; scaling handles fit */
body.in-miniapp .card       { width: 125px; height: 175px; }
body.in-miniapp .card-face  { width: 100%; height: 100%; }

/* Optional: nudge board slightly left/down if you want */
body.in-miniapp .game-container { margin-left: -8px; /* tweak */ }
